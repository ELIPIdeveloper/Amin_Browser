<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Recognition</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            background: url('background.jpg') no-repeat center center fixed;
            background-size: cover;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            font-family: Arial, sans-serif;
        }

        .microphone {
            position: relative;
            bottom: 1%;
            width: 50%;
            cursor: pointer;
        }

        .text-output {
            color: white;
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <div class="text-output" id="outputText"></div>
    <img src="microphone.png" alt="Microphone" class="microphone" id="microphone">

    <script>
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        const outputText = document.getElementById('outputText');
        const microphone = document.getElementById('microphone');

        recognition.lang = 'fa-IR';
        recognition.continuous = false; // تنها یک بار شناسایی صوتی انجام شود
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        // فعال‌سازی شناسایی صوتی با کلیک روی عکس میکروفون
        microphone.addEventListener('click', () => {
            outputText.textContent = '...در حال شناسایی';
            recognition.start();
        });

        // بررسی نتایج شناسایی صوتی
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            outputText.textContent = `متن شناسایی شده: ${transcript}`;

            // بررسی کلمات خاص
            if (transcript.includes('سلام')) {
                playSound('greeting.mp3');
            } else if (transcript.includes('چه') || transcript.includes('اسم تو چیه') || transcript.includes('کی هستی') || transcript.includes('سیری') || transcript.includes('بیکسپی')) {
                playSound('Amin.m4a');
            } else if (transcript.includes('چیست') || transcript.includes('کیست')) {
                searchGoogle(transcript);
            } else {
                playSound('default.mp3');
            }

            recognition.stop(); // متوقف کردن شناسایی صوتی پس از 10 ثانیه
        };

        // ایجاد صدا
        function playSound(audioFile) {
            const audio = new Audio(audioFile);
            audio.play();
        }

        // جستجوی گوگل
        function searchGoogle(query) {
            const searchQuery = query.replace(/ /g, '+');
            window.open(`https://www.google.com/search?q=${searchQuery}`, '_blank');
        }

        // مدیریت خطاهای شناسایی صوتی
        recognition.onerror = (event) => {
            console.error('خطای شناسایی صوتی:', event.error);
            outputText.textContent = 'خطای شناسایی صوتی!';
        };

        // محدود کردن مدت زمان شناسایی صوتی به 10 ثانیه
        recognition.onend = () => {
            outputText.textContent += ' - شناسایی صوتی متوقف شد.';
        };
    </script>

</body>
</html>
