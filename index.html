<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صداشناس</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            background: url('background.jpg') no-repeat center center fixed;
            background-size: cover;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-family: 'IRANSans', sans-serif;
        }

        .microphone-container {
            position: relative;
            width: 50%;
            max-width: 400px;
            margin-bottom: 1%;
        }

        .microphone-container img {
            width: 100%;
            height: auto;
        }

        #output-text {
            text-align: center;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="microphone-container">
        <img id="microphone" src="microphone.png" alt="میکروفون">
    </div>
    <div id="output-text"></div>

    <script>
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'fa-IR';
        recognition.continuous = false;
        recognition.interimResults = false;

        const outputText = document.getElementById('output-text');
        const microphone = document.getElementById('microphone');

        recognition.addEventListener('result', (event) => {
            const transcript = event.results[0][0].transcript;
            outputText.textContent = `متن شناسایی شده: ${transcript}`;
            processCommand(transcript);
            recognition.stop();
            setTimeout(() => startRecognition(), 1000); // دوباره ریکنگنایز را آغاز می‌کند
        });

        recognition.addEventListener('end', () => {
            if (outputText.textContent === '') {
                setTimeout(() => startRecognition(), 1000);
            }
        });

        function startRecognition() {
            recognition.start();
        }

        microphone.addEventListener('click', () => {
            outputText.textContent = 'در حال شناسایی صدا...';
            startRecognition();
        });

        function playAudio(audioFile) {
            const audio = new Audio(audioFile);
            audio.play();
        }

        function searchGoogle(query) {
            const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
            window.open(searchUrl, '_blank');
        }

        function processCommand(command) {
            const keywords = command.toLowerCase();

            if (keywords.includes('سلام')) {
                playAudio('greeting.mp3');
            } else if (keywords.includes('چیه') || keywords.includes('اسم تو چیه') || keywords.includes('ی هستی') || keywords.includes('سیری') || keywords.includes('بیکسپی')) {
                playAudio('Amin.m4a');
            } else if (keywords.includes('روشن') || keywords.includes('خاموش') || keywords.includes('تنظیم') || keywords.includes('برو تو') || keywords.includes('باز کن')) {
                playAudio('On_off_speed.m4a');
            } else if (keywords.includes('خوبی') || keywords.includes('چطوری') || keywords.includes('بهتری') || keywords.includes('حالت چطوره') || keywords.includes('حالت خوبه') || keywords.includes('تو خیلی')) {
                playAudio('Tanks.m4a');
            } else if (keywords.includes('چه خبر')) {
                playAudio('Slalamati(1).m4a');
            } else if (keywords.includes('چیست') || keywords.includes('کیست') || keywords.includes('کجاست') || keywords.includes('چطوره')) {
                searchGoogle(keywords);
            } else {
                playAudio('default.mp3');
            }
        }
    </script>
</body>
</html>
