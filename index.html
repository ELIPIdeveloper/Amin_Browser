<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ویس ریکنگنایز فارسی</title>
</head>
<body>
    <h1>تشخیص صدا و پخش فایل صوتی</h1>
    <p>بر روی دکمه زیر کلیک کنید تا صدای خود را ثبت کنید:</p>
    <button onclick="startRecognition()">شروع به صحبت</button>
    <p id="output"></p>
    <!-- عنصر audio با display:none پنهان شده است -->
    <audio id="audioPlayer" style="display:none;">
        <source src="welcome.mp3" type="audio/mpeg">
    </audio>

    <script>
        let recognition;

        function startRecognition() {
            const output = document.getElementById('output');
            const audioPlayer = document.getElementById('audioPlayer');

            // ساخت شیء SpeechRecognition
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false; // تشخیص صدا تنها یک بار انجام می‌شود
                recognition.interimResults = false;
                recognition.lang = 'fa-IR'; // زبان فارسی

                // رویداد برای نتایج تشخیص صدا
                recognition.onresult = function (event) {
                    const transcript = event.results[0][0].transcript;
                    output.textContent = `متن تشخیص داده شده: ${transcript}`;

                    // بررسی وجود کلمه "سلام"
                    if (transcript.includes("سلام")) {
                        // پخش فایل صوتی بدون نمایش عنصر audio
                        audioPlayer.play();
                    }
                };

                // شروع تشخیص صدا
                recognition.start();

                // پیام هشدار برای متوقف کردن تشخیص صدا
                recognition.onend = function () {
                    console.log('تشخیص صدا متوقف شد.');
                };
            } else {
                alert('مرورگر شما پشتیبانی از Speech Recognition نمی‌کند.');
            }
        }
    </script>
</body>
</html>
